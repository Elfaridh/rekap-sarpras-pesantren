<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Laporan | Rekap Sarpras Pesantren</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="app-header">
    <div class="brand-row">
      <img class="brand-logo" src="icons/logo-da-ibs.svg" alt="Logo Daarul Amiin IBS">
      <div class="brand">
        <h1>Laporan & Ekspor</h1>
        <p class="brand-meta">Daarul Amiin IBS</p>
        <p>Filter data aset berdasarkan lokasi, kategori, dan kondisi.</p>
      </div>
    </div>
    <div class="user-info">
      <span id="userInfo">Memuat pengguna...</span>
      <button id="logoutBtn" class="btn-secondary">Keluar</button>
    </div>
  </header>

  <nav class="app-nav">
    <a href="index.html">Dashboard</a>
    <a href="lokasi.html">Lokasi</a>
    <a href="aset.html">Aset</a>
    <a href="pemeliharaan.html">Pemeliharaan</a>
    <a href="mutasi.html">Mutasi</a>
    <a class="active" href="laporan.html">Laporan</a>
  </nav>

  <main>
    <section class="card">
      <h2>Impor Data</h2>
      <p class="muted">Unggah file CSV atau JSON untuk memasukkan data secara otomatis.</p>
      <div class="grid grid-3">
        <div>
          <label class="label" for="importType">Tipe Data</label>
          <select id="importType">
            <option value="auto">Deteksi Otomatis</option>
            <option value="lokasi">Lokasi</option>
            <option value="aset">Aset</option>
            <option value="pemeliharaan">Pemeliharaan</option>
            <option value="mutasi">Mutasi</option>
          </select>
        </div>
        <div>
          <label class="label" for="importFile">File CSV/JSON</label>
          <input id="importFile" type="file" accept=".csv,.json">
        </div>
        <div>
          <label class="label" for="autoLokasi">Opsi</label>
          <select id="autoLokasi">
            <option value="ya">Tambah lokasi baru otomatis</option>
            <option value="tidak">Hanya pakai lokasi yang ada</option>
          </select>
        </div>
      </div>
      <div class="action-group" style="margin-top:12px;">
        <button id="importButton" class="btn-primary">Impor Data</button>
      </div>
      <p id="importMessage" class="muted"></p>
      <div class="notice" style="margin-top:12px;">
        <strong>Petunjuk Kolom CSV</strong>
        <ul class="muted">
          <li>Lokasi: Nama, Kategori/Tipe, Catatan</li>
          <li>Aset: Nama, Lokasi, Kategori, Kondisi, Jumlah, Tahun</li>
          <li>Pemeliharaan: Aset, Tanggal, Catatan</li>
          <li>Mutasi: Aset, Dari, Ke, Tanggal, Penanggung Jawab</li>
        </ul>
      </div>
    </section>

    <section class="card">
      <h2>Filter Laporan</h2>
      <div class="grid grid-3">
        <div>
          <label class="label" for="laporanLokasi">Lokasi</label>
          <select id="laporanLokasi"></select>
        </div>
        <div>
          <label class="label" for="laporanKategori">Kategori</label>
          <select id="laporanKategori">
            <option value="">Semua</option>
            <option value="Mebel">Mebel</option>
            <option value="Elektronik">Elektronik</option>
            <option value="Bangunan">Bangunan</option>
            <option value="Alat Ibadah">Alat Ibadah</option>
            <option value="IT">IT</option>
            <option value="Lainnya">Lainnya</option>
          </select>
        </div>
        <div>
          <label class="label" for="laporanKondisi">Kondisi</label>
          <select id="laporanKondisi">
            <option value="">Semua</option>
            <option value="Baik">Baik</option>
            <option value="Rusak">Rusak</option>
            <option value="Rusak Berat">Rusak Berat</option>
          </select>
        </div>
      </div>
      <div class="action-group" style="margin-top:12px;">
        <button id="refreshLaporan" class="btn-primary">Tampilkan</button>
        <button id="exportAset" class="btn-secondary">Ekspor Aset (CSV)</button>
      </div>
    </section>

    <section class="card">
      <h2>Ringkasan Laporan</h2>
      <div class="grid grid-3">
        <div class="stat">
          <span class="muted">Total Aset</span>
          <h3 id="laporanTotal">0</h3>
        </div>
        <div class="stat">
          <span class="muted">Kondisi Baik</span>
          <h3 id="laporanBaik">0</h3>
        </div>
        <div class="stat">
          <span class="muted">Perlu Perawatan</span>
          <h3 id="laporanPerlu">0</h3>
        </div>
      </div>
      <table class="table" style="margin-top:12px;">
        <thead>
          <tr>
            <th>Nama</th>
            <th>Lokasi</th>
            <th>Kategori</th>
            <th>Kondisi</th>
            <th>Jumlah</th>
          </tr>
        </thead>
        <tbody id="laporanTable"></tbody>
      </table>
    </section>

    <section class="card">
      <h2>Ekspor Data Lain</h2>
      <div class="action-group">
        <button id="exportLokasi" class="btn-secondary">Ekspor Lokasi</button>
        <button id="exportPemeliharaan" class="btn-secondary">Ekspor Pemeliharaan</button>
        <button id="exportMutasi" class="btn-secondary">Ekspor Mutasi</button>
      </div>
    </section>
  </main>

  <footer class="footer">Ekspor CSV dapat dibuka di Excel atau Google Sheets.</footer>

  <script src="js/db.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/export.js"></script>
  <script src="js/import.js"></script>
  <script src="js/laporan.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
